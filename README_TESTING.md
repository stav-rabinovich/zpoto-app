# 🧪 מדריך בדיקה - מערכת זמינות חניות

**🎯 מטרה: אחרי ביצוע כל הבדיקות בקובץ זה, נדע בדיוק מה עובד ומה צריך לתקן.**

---

## 🚀 **שלב 0: הכנה והרצה**

### **סתיו** (Backend + Setup):
```bash
# Terminal 1 - Backend
cd /Users/stavrabinovich/Desktop/Zpoto-app/backend
npm run dev

# Terminal 2 - Frontend  
cd /Users/stavrabinovich/Desktop/Zpoto-app/frontend/client
npm start
```

### **ישראל** (Mobile):
1. 📱 **פתח Expo Go** בטלפון
2. 📷 **סרוק QR code** מהטרמינל
3. ✅ **ודא שהאפליקציה נטענת** ללא שגיאות אדומות

### **סתיו** (Admin):
1. 💻 **פתח דפדפן**: `http://localhost:4000/admin`
2. 🔑 **התחבר כאדמין**
3. 👤 **מצא משתמש עם role OWNER** - העתק את המייל שלו

---

## 📋 **שלב 1: בדיקת מערכת זמינות חדשה (6 בלוקים)**

### **ישראל** (בעל חניה):
1. 🏠 **באפליקציה** → "בעלי חניה"
2. ✉️ **הזן מייל** שסתיו נתן לך
3. ➡️ **לחץ המשך** → אמור להיכנס למסך ניהול
4. 🅿️ **בחר חניה** → "ערוך זמינות"

### **✅ מה לבדוק - ישראל:**
- [ ] **רואה 6 בלוקים** (לא 4): `00:00-04:00`, `04:00-08:00`, `08:00-12:00`, `12:00-16:00`, `16:00-20:00`, `20:00-24:00`
- [ ] **הטקסט אומר** "כל בלוק מכסה 4 שעות"
- [ ] **יכול להדליק/לכבות** בלוקים ללא שגיאות

### **סתיו** (בקונסול):
**👀 מה לחפש:**
```
🔄 Migrating old availability format to new 4-hour blocks
✅ Parsed availability data for parking X
📡 Broadcasting availability update via WebSocket
```

---

## 🛡️ **שלב 2: בדיקת בקרת התנגשויות**

### **סתיו** (הכנת נתונים):
1. 💻 **באדמין** → טבלת `Bookings`
2. ➕ **צור הזמנה:**
   - **parkingId**: חניה של ישראל
   - **startTime**: מחר 10:00
   - **endTime**: מחר 14:00
   - **status**: `CONFIRMED`
3. 📝 **הודע לישראל** על מזהה החניה

### **ישראל** (בדיקת חסימה):
1. 🅿️ **כנס לזמינות** של החניה עם ההזמנה
2. 🚫 **נסה לכבות בלוק 08:00-12:00** (מתנגש!)

### **✅ מה אמור לקרות - ישראל:**
- [ ] **הודעת שגיאה** "לא ניתן לשנות זמינות"
- [ ] **פרטי ההזמנה** מוצגים (שם + תאריכים)
- [ ] **הבלוק לא מתכבה**

---

## 📡 **שלב 3: בדיקת עדכונים בזמן אמת**

### **הכנה:**
- 💻 **סתיו**: פתח Admin
- 📱 **ישראל**: מסך חיפוש חניות

### **הבדיקה:**
1. 💻 **סתיו**: שנה זמינות חניה באדמין
2. 📱 **ישראל**: חפש חניות באותו אזור

### **✅ מה אמור לקרות:**
- [ ] **ישראל רואה** הודעה ירוקה "זמינות חניות עודכנה" (3 שניות)
- [ ] **תוצאות החיפוש משתנות** בהתאם
- [ ] **סתיו רואה בקונסול** `📡 Broadcasted availability update`

---

## 🔔 **שלב 4: בדיקת מערכת התראות**

### **ישראל**:
1. 🏠 **במסך ניהול החניות** → כפתור התראות 🔔
2. ⚙️ **לחץ הגדרות** (גלגל שיניים)
3. 🧪 **לחץ "שלח התראת בדיקה"**

### **✅ מה לבדוק - ישראל:**
- [ ] **התראת הבדיקה מופיעה** ברשימה
- [ ] **מונה התראות מתעדכן**
- [ ] **מסך הגדרות פתח** ללא שגיאות

---

## 📅 **שלב 5: בדיקת "חניות עתידיות"**

### **ישראל**:
1. 🏠 **במסך בעל החניה**
2. 📅 **חפש מסך "חניות עתידיות"** (לא "בקשות בהמתנה")
3. 👆 **לחץ עליו**

### **✅ מה לבדוק - הזמנות עתידיות:**

#### **הזמנות עתידיות:**
- [ ] **רואה הזמנות מאושרות** העתידות לקרות
- [ ] **פרטי הזמנה** כוללים לקוח, זמן, מחיר
- [ ] **Widget צפי הכנסות** למעלה עם 3 כרטיסים

---

## 🔍 **שלב 6: בדיקת חיפוש ומפה (סתיו)**

### **סתיו** (מחפש חניות):
1. 📱 **פתח את האפليקציה** (ללא התחברות)
2. 🔍 **חפש "תל אביב"**
3. 📍 **זוז במפה לאזור אחר**
4. 🔘 **לחץ "חפש כאן"** (כפתור כחול)

### **✅ מה לבדוק - סתיו:**
- [ ] **כפתור "חפש כאן" עובד** ומציג חניות באזור החדש
- [ ] **אם אין חניות** - מופיעה הודעה ברורה
- [ ] **ללא שגיאות אדומות** בקונסול

---

## 💙 **שלב 7: בדיקת מועדפים (סתיו)**

### **סתיו**:
1. 🔍 **בתוצאות חיפוש** 
2. ❤️ **לחץ על לב** ליד חניה
3. 📋 **כנס למסך מועדפים**
4. ❤️ **הסר מועדף** באותו מסך

### **✅ מה לבדוק - סתיו:**
- [ ] **הלב מתמלא אדום** כשמוסיפים
- [ ] **החניה מופיעה במועדפים**
- [ ] **הסרת מועדף עובדת**
- [ ] **הלב נעלם** אחרי הסרה

---

## 🗺️ **שלב 8: בדיקת "הצג במפה" (סתיו)**

### **סתיו**:
1. 🔍 **בתוצאות חיפוש**
2. 🗺️ **לחץ "הצג במפה"** על חניה
3. 👀 **ודא שהמפה זמה** לחניה הנבחרת

### **✅ מה לבדוק - סתיו:**
- [ ] **המפה זמה** לחניה שנבחרה
- [ ] **החניה מודגשת** במפה
- [ ] **ללא שגיאות** בתנועה

---

## 📝 **שלב 9: בדיקת "הזמן עכשיו" (סתיו)**

### **סתיו**:
1. 🔍 **בתוצאות חיפוש**
2. 📝 **לחץ "הזמן עכשיו"** על חניה
3. 👀 **ראה מה קורה**

### **✅ מה אמור לקרות - סתיו:**
- [ ] **הודעה "נדרשת התחברות"** מופיעה
- [ ] **כפתורי "ביטול" ו"התחבר"** עובדים
- [ ] **ללא crash** או שגיאות אדומות

---

## 📊 **סיכום - רשימת בדיקות**

### **✅ תכונות חדשות שפיתחנו:**
- [ ] **6 בלוקי זמינות** של 4 שעות כל אחד
- [ ] **חסימת עריכה** כשיש הזמנות קיימות
- [ ] **עדכונים בזמן אמת** במפה וחיפוש
- [ ] **מערכת התראות** לבעלי חניה
- [ ] **מסך חניות עתידיות** עם צפי הכנסות
- [ ] **כפתור "חפש כאן"** במפה
- [ ] **מועדפים** ללא התחברות (anonymous)
- [ ] **"הצג במפה"** בתוצאות חיפוש
- [ ] **"הזמן עכשיו"** עם בדיקת התחברות

### **✅ תיקונים שבוצעו:**
- [ ] **מועדפים** - פועלים בלי שגיאות
- [ ] **חיפוש במפה** - "חפש כאן" עובד
- [ ] **ניווט במפה** - "הצג במפה" עובד
- [ ] **הזמנות** - "הזמן עכשיו" עובד עם authentication

---

## 🚨 **איך לדווח על בעיות:**

### **אם משהו לא עובד:**
1. 📷 **צלם מסך** של הבעיה
2. 📝 **רשום מה עשית** בדיוק
3. 📝 **מה ציפית** שיקרה
4. 🔍 **הועתק שגיאות** מהקונסול (אם יש)

### **פורמט דיווח:**
```
❌ בעיה: [תיאור קצר]
🔧 מה עשיתי: [צעדים בדיוק]
🎯 מה ציפיתי: [מה אמור היה לקרות]
💥 מה קרה: [מה קרה במציאות]
📱 מכשיר: [iPhone/Android/Web]
🖼️ צילום מסך: [מצורף]
```

---

## 🎉 **בסיום הבדיקות:**

אחרי שסיימתם את כל הבדיקות, נדע בדיוק:
- ✅ מה עובד טוב
- ❌ מה צריך תיקון
- 🔧 איזה תיקונים דחופים
- 📈 איך המערכת מתנהגת בפועל

**מוכנים? בואו נתחיל! 🚀**
