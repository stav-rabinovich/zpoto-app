## ğŸ“˜ README.md â€“ ZPOTO CODEBASE REFACTOR PLAN
**Version:** 1.0  
**Author:** Stav Rabinovich  
**Goal:** Achieve a fully organized, modular, and maintainable Zpoto codebase â€” keeping 100% of current functionality intact.

---

# ğŸ§­ ×©×œ×‘ 1 â€“ ××™×¤×•×™ ×•×”×‘× ×ª ×”××¢×¨×›×ª ×”×§×™×™××ª  
**××˜×¨×”:** ×œ×”×‘×™×Ÿ ××” ×‘×××ª ×§×™×™×, ××” ×‘×©×™××•×© ×•××” ×œ×.  
**××©×š:** 1â€“2 ×™××™×  

### ğŸ§© ××©×™××•×ª:
1. **×‘×“×™×§×ª ×ª×œ×•×ª×™×:**
   ```bash
   npx depcheck
   ```
   - [x] ×¨×©×•× ××ª ×›×œ ×”×¡×¤×¨×™×•×ª ×”×œ× ×‘×©×™××•×©.
   - [x] ××—×§ ×¡×¤×¨×™×•×ª ×œ× ×‘×©×™××•×© ××—×¨×™ ××™××•×ª.
   - **×ª×•×¦××”:** × ×•×¦×¨ `DEPENDENCY_AUDIT.md` ×¢× 6 ×ª×œ×•×ª×™× ×œ× ×‘×©×™××•×© ×•-4 ×—×¡×¨×™×

2. **×‘×“×™×§×ª ×§×‘×¦×™× ×œ× ×‘×©×™××•×©:**
   ```bash
   npx ts-prune  # ×“×¨×© tsconfig.json - ×‘×•×¦×¢ ×™×“× ×™×ª
   ```
   - [x] ×¨×©×•× ×§×‘×¦×™× ×©×œ× ××™×•×‘××™×.
   - [x] ×—×œ×§ ××•×ª× ×œ×¤×™:  
     âœ… ×‘×©×™××•×© | âš ï¸ ×œ×‘×“×•×§ | âŒ ×œ××—×•×§  
   - **×ª×•×¦××”:** × ×•×¦×¨ `UNUSED_FILES_AUDIT.md` ×¢× ~15 ×§×‘×¦×™ debug ×œ××—×™×§×”

3. **×‘× ×™×™×ª ××¤×ª ××¢×¨×›×ª:**
   - [x] ×©×¨×˜×˜ ×–×¨×™××” ×‘×¡×™×¡×™×ª ×©×œ:  
     `Frontend â†’ Backend â†’ Prisma â†’ DB`.  
   - [x] ×–×”×” ××™×œ×• endpoints ×¤×¢×™×œ×™× ×•××™×œ×• ××™×•×ª×¨×™×.  
   - [x] ×ª×¢×“ ×‘××¡××š `SYSTEM_MAP.md`.
   - **×ª×•×¦××”:** ××¤×” ××œ××” ×©×œ 66 ×§×‘×¦×™×, 24 routes, 38 screens

---

# ğŸ—ï¸ ×©×œ×‘ 2 â€“ ××—×™×“×•×ª ××‘× ×” ×•××¨×’×•×Ÿ ×ª×™×§×™×•×ª  
**××˜×¨×”:** ×œ×™×¦×•×¨ ×”×™×¨×¨×›×™×” ×”×’×™×•× ×™×ª ×•×‘×¨×•×¨×” ×œ×¤×™ ××•×¡×›××•×ª ×¢×•×œ××™×•×ª.  
**××©×š:** 2â€“3 ×™××™×  

### ğŸ“ ××‘× ×” ×™×¢×“:
```
/app
  /components
    /shared
    /parking
    /booking
    /payment
  /screens
  /hooks
  /context
  /utils
  /services
  /assets
/backend
  /controllers
  /routes
  /models
  /services
  /middlewares
  /prisma
```

### ğŸ§© ××©×™××•×ª:
- [x] ×”×–×–×ª ×§×‘×¦×™× ×œ××™×§×•××™× ×”×—×“×©×™× - **×”××‘× ×” ×›×‘×¨ ×××•×¨×’×Ÿ ×˜×•×‘!**
- [x] ××—×™×§×ª ×ª×™×§×™×•×ª "old" / "temp" - **××—×§× ×• ~15 ×§×‘×¦×™ debug ×•-ServerOnly***
- [x] ××—×™×“×•×ª ×©××•×ª (PascalCase ×œ×§×•××¤×•× × ×˜×•×ª, camelCase ×œ×¤×•× ×§×¦×™×•×ª) - **×›×‘×¨ ××—×™×“!**
- [ ] ×”×—×œ×¤×ª ×›×œ `.js` ×œÖ¾`.ts` / `.tsx` - **× ×“×—×” ×œ×©×œ×‘ ×××•×—×¨ ×™×•×ª×¨**

**×ª×•×¦××•×ª ×©×œ×‘ 2:**
- ××—×§× ×• 15+ ×§×‘×¦×™ debug ×–×× ×™×™× ××”backend
- ××™×—×“× ×• ×›×¤×™×œ×•×™×•×ª: BookingDetailScreen, Dashboard  
- ××—×§× ×• ××¡×›×™ Migration ×•-ServerOnly ×©×œ× ×‘×©×™××•×©
- ×”××‘× ×” ×”×§×™×™× ×›×‘×¨ ×××•×¨×’×Ÿ ×˜×•×‘ ×¢× ×ª×™×§×™×•×ª ×œ×•×’×™×•×ª  

---

# âš™ï¸ ×©×œ×‘ 3 â€“ × ×™×§×•×™ ×§×•×“ ×•×›×¤×™×œ×•×™×•×ª  
**××˜×¨×”:** ×œ×¦××¦× ×§×•×“ ××©×•×›×¤×œ ×•×œ×¨×›×– ×œ×•×’×™×§×” ×—×•×–×¨×ª.  
**××©×š:** 3â€“4 ×™××™×  

### ğŸ§© ××©×™××•×ª:
1. **××™×ª×•×¨ ×›×¤×™×œ×•×™×•×ª:**
   ```bash
   npx jscpd --min-tokens 40 --reporters console
   ```
   - [ ] ×¨×©×•× ××ª ×›×œ ×”××§×¨×™× ×©×—×•×–×¨×™× ×¢×œ ×¢×¦××.  
   - [ ] ×”×¢×‘×¨ ×œ×¤×•× ×§×¦×™×•×ª ×‘Ö¾`/utils` ××• hooks ×‘Ö¾`/hooks`.

2. **××™×—×•×“ ×¤×•× ×§×¦×™×•×ª ×¢×–×¨:**
   - [ ] ×¦×•×¨ `/utils/general.ts`.  
   - [ ] ×¨×›×– ×¤×•× ×§×¦×™×•×ª ×›××• `formatDate`, `calculateFee`, `parseLicensePlate`.  

3. **×”×¡×¨×ª ×§×•×“ ×™×©×Ÿ:**
   - [ ] ××—×§ `console.log` ×•Ö¾debugs.  
   - [ ] ××—×§ ××©×ª× ×™× ×–×× ×™×™× (`temp`, `test`, `dummy`).  

---

# ğŸ”„ ×©×œ×‘ 4 â€“ × ×™×”×•×œ State ×•×©×™××•×© ×—×›× ×‘Ö¾Hooks  
**××˜×¨×”:** ×œ×× ×•×¢ ×¨×™×‘×•×™ ××©×ª× ×™× ×•Ö¾prop drilling.  
**××©×š:** 2â€“3 ×™××™×  

### ğŸ§© ××©×™××•×ª:
- [ ] ×¦×•×¨ `AppContext.tsx` ×¢× state ×’×œ×•×‘×œ×™:  
  - `currentUser`  
  - `activeBooking`  
  - `selectedParking`  
- [ ] ×”×—×œ×£ `useState` ×›×¤×•×œ×™× ×‘Ö¾context.  
- [ ] ×”×¢×‘×¨ ×œ×•×’×™×§×” ×—×•×–×¨×ª ×œÖ¾custom hooks (×œ××©×œ: `useBookingTimer`, `useParkingAvailability`).  
- [ ] ×•×“× ×©×›×œ `useEffect` ×›×•×œ×œ ×ª×œ×•×ª×™× × ×›×•× ×™× ×‘×œ×‘×“.  

---

# ğŸ”§ ×©×œ×‘ 5 â€“ Backend Refactor  
**××˜×¨×”:** ×œ×¤×©×˜ ××ª ×¦×“ ×”×©×¨×ª, ×œ×”×¡×™×¨ ×—×–×¨×•×ª ×•×œ×•×•×“× ×¢×§×‘×™×•×ª.  
**××©×š:** 3 ×™××™×  

### ğŸ§© ××©×™××•×ª:
1. **×‘×“×™×§×ª endpoints:**
   - [x] ×¢×‘×•×¨ ×¢×œ ×›×œ route ×•×•×“× ×©×”×•× ×‘×©×™××•×© ×¢"×™ frontend.  
   - [x] ××—×§ ××• ×¡×’×•×¨ endpoints ×™×©× ×™×.
   - **×ª×•×¦××”:** ××—×§× ×• chat.routes.ts ×•-quick-fix.routes.ts (×œ× ×‘×©×™××•×©)

2. **×ª×™×¢×•×“ Controllers:**
   - [x] ×•×“× ×©×›×œ controller ××—×–×™×¨ JSON ××—×™×“:
     ```json
     { "success": true, "data": {}, "message": "" }
     ```
   - **×ª×•×¦××”:** ×™×¦×¨× ×• responseFormatter middleware ×œ××—×™×“×•×ª

3. **Prisma:**
   ```bash
   npx prisma validate
   npx prisma format
   ```
   - [x] ×•×“× ×©×”Ö¾schema ×ª×•×× ×œ×§×•×“.  
   - [x] ××—×§ ××•×“×œ×™× ×™×©× ×™×.
   - **×ª×•×¦××”:** Schema ×ª×§×™×Ÿ ×•××¤×•×¨××˜

**×ª×•×¦××•×ª ×©×œ×‘ 5:**
- ××—×§× ×• 2 routes ×œ× ×‘×©×™××•×© (~6KB)
- ×™×¦×¨× ×• middleware ×œ××—×™×“×•×ª JSON responses
- ××•×“×™×˜ ××œ× ×©×œ 24 endpoints - 18 ×‘×©×™××•×© ×¤×¢×™×œ
- Schema ××¤×•×¨××˜ ×•×ª×§×™×Ÿ  

---

# ğŸ¨ ×©×œ×‘ 6 â€“ Lint, Formatting & Standards  
**××˜×¨×”:** ×œ×™×¦×•×¨ ×¡×’× ×•×Ÿ ××—×™×“ ×•× ×§×™ ×œ×›×œ ×”×§×•×“.  
**××©×š:** ×™×•× ××—×“  

### ğŸ§© ××©×™××•×ª:
1. ×”×ª×§× ×ª ×›×œ×™×:
   ```bash
   npm i eslint prettier @typescript-eslint/parser @typescript-eslint/eslint-plugin eslint-config-prettier eslint-plugin-prettier -D
   npx eslint . --fix
   npx prettier --write .
   ```
   - [x] **×”×•×ª×§×Ÿ ×‘backend ×‘×”×¦×œ×—×”**

2. ×¦×•×¨ ×§×•×‘×¥ `.prettierrc`:
   ```json
   {
     "semi": true,
     "singleQuote": true,
     "trailingComma": "es5"
   }
   ```
   - [x] **× ×•×¦×¨ ×¢× ×”×’×“×¨×•×ª ××ª×§×“××•×ª**

3. ×”×¤×¢×œ ESLint ××•×˜×•××˜×™×ª ×œ×¤× ×™ ×›×œ commit:
   ```bash
   npx husky install
   npx husky add .husky/pre-commit "npm run lint"
   ```
   - [x] **× ×•×¦×¨×• scripts: lint, lint:fix, format, format:check**

**×ª×•×¦××•×ª ×©×œ×‘ 6:**
- ×”×•×ª×§× ×• ×›×œ×™ linting ××ª×§×“××™× ×œbackend
- × ×•×¦×¨ eslint.config.js ×‘×¤×•×¨××˜ ×”×—×“×© (ESLint v9)
- ×›×œ ×”×§×•×“ ×‘backend ×¤×•×¨××˜ ××•×˜×•××˜×™×ª
- × ×•×¦×¨×• scripts ×œlinting ×•-formatting
- ×”×§×•×“ ×¢×›×©×™×• ×¢×§×‘×™ ×•× ×§×™

---

# ğŸ§ª ×©×œ×‘ 7 â€“ ×‘×“×™×§×•×ª ×•××™××•×ª ××¢×¨×›×ª  
**××˜×¨×”:** ×œ×•×•×“× ×©×œ× × ×©×‘×¨ ×©×•× ×¤×™×¦×³×¨.  
**××©×š:** 2â€“3 ×™××™×  

### ğŸ§© ××©×™××•×ª:
- [ ] ×”×ª×§× ×ª Jest:
  ```bash
  npm i jest @testing-library/react-native -D
  npm run test
  ```
- [ ] ×¦×•×¨ ×‘×“×™×§×•×ª smoke ×œ×›×œ ××¡×š ×¢×™×§×¨×™.  
- [ ] ×¦×•×¨ ×‘×“×™×§×•×ª ×œÖ¾hooks ×•×œÖ¾utils.  
- [ ] ×•×“× ×©×›×œ ×”×‘×“×™×§×•×ª ×¢×•×‘×¨×•×ª.  

---

# ğŸ§¾ ×©×œ×‘ 8 â€“ ×ª×™×¢×•×“ ×§×•×“ ×•Ö¾README ×¡×•×¤×™  
**××˜×¨×”:** ×©×›×œ ××¤×ª×— ×—×“×© ×™×‘×™×Ÿ ××ª ×”××¢×¨×›×ª ×ª×•×š ×“×§×•×ª.  
**××©×š:** 1â€“2 ×™××™×  

### ğŸ§© ××©×™××•×ª:
1. ×‘×¨××© ×›×œ ×§×•×‘×¥:
   ```ts
   /**
    * Component: ParkingCard
    * Description: Displays parking spot info
    * Author: Stav Rabinovich
    * Updated: 2025-10-29
    */
   ```

2. ×œ×›×œ ×¤×•× ×§×¦×™×” ×¢×–×¨:
   ```ts
   /**
    * Calculates parking duration
    * @param {Date} start
    * @param {Date} end
    * @returns {number} totalMinutes
    */
   ```

3. ×¢×“×›×•×Ÿ `README.md` ×”×¡×•×¤×™:
   - ×–×¨×™××ª × ×ª×•× ×™×.  
   - ××‘× ×” ×ª×™×§×™×•×ª.  
   - ×”× ×—×™×•×ª ×¤×™×ª×•×— ×•×ª×¨×•××”.  

---

# ğŸš€ ×©×œ×‘ 9 â€“ ×‘×§×¨×ª ××™×›×•×ª (CI/CD)
**××˜×¨×”:** ×œ××›×•×£ ××™×›×•×ª ×§×•×“ ×‘×›×œ commit.  
**××©×š:** ×™×•× ××—×“  

### ğŸ§© ××©×™××•×ª:
×¦×•×¨ ×§×•×‘×¥ `.github/workflows/quality.yml`:
```yaml
name: Code Quality
on: [push, pull_request]
jobs:
  lint-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: 20
      - run: npm ci
      - run: npm run lint
      - run: npm test
```

---

# âœ… ×©×œ×‘ 10 â€“ ×‘×§×¨×ª ×ª×•×¦××•×ª ×•×¡×™×›×•×

| ××“×“ | ×œ×¤× ×™ | ×™×¢×“ |
|------|--------|-------|
| ×©×•×¨×•×ª ×§×•×“ | ~100,000 | â‰¤ 70,000 |
| ×›×¤×™×œ×•×™×•×ª | ~20% | â‰¤ 5% |
| ×¡×¤×¨×™×•×ª ×œ× ×‘×©×™××•×© | 15â€“25% | 0% |
| ×–××Ÿ ×˜×¢×™× ×” | ~80 ×©× ×™×•×ª | â‰¤ 45 ×©× ×™×•×ª |
| ×–××Ÿ ×§×œ×™×˜×” ×œ××¤×ª×— ×—×“×© | 3 ×™××™× | â‰¤ 1 ×™×•× |

---

## ğŸ’¡ ×”×¢×¨×•×ª ××—×¨×•× ×•×ª:
- ××œ ×ª×©× ×” ×¤×•× ×§×¦×™×•× ×œ×™×•×ª ××œ× ×× ×™×© ×‘××’ ××•×›×—.  
- ×©××•×¨ ×¢×œ commit×™× ×§×˜× ×™× ×•××“×•×™×§×™×.  
- ×›×œ ×©×™× ×•×™ ×‘××‘× ×” â€” ×ª×¢×“ ×‘Ö¾Changelog.  
- ×”×§×¤×“ ×©×›×œ feature ×—×“×© ×™×™×›× ×¡ ×‘××‘× ×” ×”×–×”, ×œ× ×›×ª×™×§×™×™×” ×—×™×¦×•× ×™×ª.

